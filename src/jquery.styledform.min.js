/**
 * jQuery Styled Form plugin (packed)
 *
 * Inspired by styledinput.js by Ryan Fait (http://ryanfait.com)
 *
 * @author  James Halsall <james.t.halsall@googlemail.com>
 * @link    http://www.github.com/jaitsu87/jQuery-StyledForm
 * @license GPL (http://www.gnu.org/licenses/gpl-3.0.html)
 * @version 1.1.0
 */
(function(e){e.fn.styledForm=function(){var t=e.styledForm,n=t.config,r=e(this),i="",s;if(n.styledClass){i="input."+n.styledClass+'[type="checkbox"], input.'+n.styledClass+'[type="radio"]';s="select."+n.styledClass}else{i='input[type="checkbox"], input[type="radio"]';s="select"}var o=r.find(i);e.each(o,function(r,i){var s=e("<span>").addClass(e(i).attr("type"));if(e(i).prop("checked")){var o;if(e(i).attr("type")=="checkbox"){o=n.checkboxHeight}else{o=n.radioHeight}s.css("background-position","0 -"+o*2+"px")}if(e(i).attr("type")=="radio"){s.attr("data-field-name",e(i).attr("name"))}e(i).before(s);if(e(i).attr("disabled")){s.addClass("disabled")}e(i).css("display","none");t.addElement(s)});var u=r.find(s);e.each(u,function(r,i){var s=e(i).find("option:selected");var o=t._canonicalize(e(i).attr("name"));var u=e("<span>",{"class":"select",id:"styled-select-"+o});var a=e(i).width()+n.selectArrowWidth;u.append(s.text());u.css("width",a);var f=e("<span>",{"class":"select-arrow"});u.append(f);e(i).before(u);e(i).css("width",a);var l=e(i).parent();if(!l.is("form")){l.css("width",a)}if(e(i).attr("disabled")){e(i).prev().addClass("disabled")}t.addElement(u)});r.on("change",t.change);r.on("mousedown",t.beforeClick);r.on("mouseup",t.afterClick);if(n.pollFrequency!==false){setInterval(t.poll,n.pollFrequency)}};e.styledForm={config:{checkboxHeight:22,radioHeight:22,selectArrowWidth:30,styledClass:"",pollFrequency:1e3},_elements:[],addElement:function(t){if(!t instanceof jQuery){t=e(t)}this._elements.push(t)},poll:function(){var t=e.styledForm;e.each(t._elements,function(t,n){var r=e(n),i;if(r.hasClass("select")){i=r.next("select")}else{i=r.next("input")}if(i.attr("disabled")&&!r.hasClass("disabled")){r.addClass("disabled")}else if(!i.attr("disabled")&&r.hasClass("disabled")){r.removeClass("disabled")}})},beforeClick:function(t){if(t.which&&t.which==3){return}var n=e.styledForm.config;var r=e(t.target);var i=r.next();if(r.attr("for")){i=e("#"+r.attr("for"));r=i.prev("span")}var s=r.attr("class");if(i.attr("disabled")||!e.styledForm._isStyledElement(i)){return}if(e.inArray(s,["checkbox","radio"])!==-1){var o="0 -";var u=s=="checkbox"?n.checkboxHeight:n.radioHeight;var a=u;if(r.prop("checked")){a=u*3}o+=a+"px";r.css("background-position",o)}},afterClick:function(t){if(t.which&&t.which==3){return}var n=e.styledForm.config;var r=e(t.target);var i=r.next("input");if(r.attr("for")){i=e("#"+r.attr("for"));r=i.prev("span")}var s=i.attr("type");if(i.attr("disabled")||!e.styledForm._isStyledElement(i)){return}if(s=="radio"){var o=e(this).find('input[type="radio"][name="'+i.attr("name")+'"]');e.each(o,function(t,n){if(n!=i.get().nextSibling&&e(n).prev()){e(n).prev().css("background-position","0 0");e(n).removeAttr("checked")}});r.css("background-position","0 -"+n.radioHeight*2+"px");i.prop("checked",true)}else if(s=="checkbox"){if(i.prop("checked")){r.css("background-position","0 0");i.removeAttr("checked")}else{r.css("background-position","0 -"+n.checkboxHeight*2+"px");i.prop("checked",true)}}},change:function(t){var n=e.styledForm.config;var r=e(t.target);var i=r.attr("type");if(!e.styledForm._isStyledElement(r)){return}var s=e.styledForm._canonicalize(r.attr("name"));if(i=="checkbox"){var o=r.parent().find(".checkbox");if(r.prop("checked")){o.css("background-position","0 -"+n.checkboxHeight*2+"px");r.removeAttr("checked")}else{o.css("background-position","0 0");r.prop("checked",true)}}else if(i!="radio"){var u=r.find("option:selected");e(this).find("#styled-select-"+s).html(u.text()+'<span class="select-arrow"></span>')}},_isStyledElement:function(t){var n=e.styledForm.config.styledClass;if(n){return t.hasClass(n)}return true},_canonicalize:function(t){if(!t){return""}return e.trim(t.replace("[","").replace("]","-"))}}})(jQuery)